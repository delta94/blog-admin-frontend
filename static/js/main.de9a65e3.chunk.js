(this["webpackJsonpblog-admin-frontend"]=this["webpackJsonpblog-admin-frontend"]||[]).push([[0],{22:function(e,t,a){e.exports=a(37)},27:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),l=a.n(c),o=a(2),s=(a(27),a(1)),u=a.n(s),i=a(4),m=a(3);function p(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),s=Object(o.a)(l,2),p=s[0],h=s[1],d=Object(n.useState)({message:""}),b=Object(o.a)(d,2),f=b[0],g=b[1],E=Object(m.f)(),v=function(){var e=Object(i.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("https://julio22b-blog-api-1.glitch.me/api/log-in",{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({username:a,password:p})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(r=e.sent).token){e.next=12;break}return localStorage.setItem("currentUser",JSON.stringify(r)),E.push("/home"),window.location.reload(),e.abrupt("return");case 12:g(r),h("");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"log-in-form",onSubmit:function(e){return v(e)}},r.a.createElement("p",null,f.message),r.a.createElement("label",{htmlFor:"username"},"Username: "),r.a.createElement("input",{type:"text",name:"username",required:!0,value:a,onChange:function(e){return c(e.target.value)}}),r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{type:"password",name:"password",required:!0,value:p,onChange:function(e){return h(e.target.value)}}),r.a.createElement("button",null,"Log in ")))}function h(e){var t=e.value,a=e.handleChange;return r.a.createElement("input",{type:"radio",name:"published",value:t,onChange:a})}function d(){var e=JSON.parse(localStorage.getItem("currentUser"));return e&&e.token?"Bearer ".concat(e.token):{}}a(18),a(19);var b=a(12);function f(e){var t=e.location,a=Object(n.useState)(""),c=Object(o.a)(a,2),l=c[0],s=c[1],p=Object(n.useState)(""),f=Object(o.a)(p,2),g=f[0],E=f[1],v=Object(n.useState)(!0),j=Object(o.a)(v,2),O=j[0],x=j[1],y=Object(n.useState)(""),w=Object(o.a)(y,2),S=w[0],k=w[1],N=Object(n.useState)(""),C=Object(o.a)(N,2),T=C[0],F=C[1],I=Object(n.useState)([]),U=Object(o.a)(I,2),P=U[0],D=U[1],J=Object(m.f)(),_=function(){var e=Object(i.a)(u.a.mark((function e(t){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),a={title:l,text:g,published:O,image:S},console.log(a),e.next=6,fetch("https://julio22b-blog-api-1.glitch.me/api/post/create",{method:"post",headers:{"Content-Type":"application/json",Authorization:d()},mode:"cors",body:JSON.stringify(a)});case 6:return n=e.sent,e.next=9,n.json();case 9:if(r=e.sent,400!==n.status){e.next=16;break}return D(r),window.scrollTo(0,0),e.abrupt("return");case 16:console.log(r),J.push("/home");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}(),A=Object(n.useRef)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"errors"},P.length>0?P.map((function(e){return r.a.createElement("li",{key:e.msg},e.msg)})):""),r.a.createElement("form",{className:"create-form",onSubmit:function(e){return _(e)},encType:"multipart/form-data"},r.a.createElement("label",{htmlFor:"title"},"Title: "),r.a.createElement("input",{type:"text",name:"title",required:!0,value:t.state?t.state.title:l,onChange:function(e){return s(e.target.value)}}),r.a.createElement("label",{htmlFor:"text"},"Content: "),r.a.createElement(b.Editor,{previewStyle:"vertical",initialEditType:"markdown",height:"700px",events:{change:function(){return E(A.current.getInstance().getMarkdown())}},ref:A,initialValue:t.state?t.state.text:""}),r.a.createElement("label",{htmlFor:"image"},"Image: "),r.a.createElement("input",{type:"file",name:"image",accept:".png, .jpg, .jpeg",onChange:function(e){return function(e){F(URL.createObjectURL(e.target.files[0]));var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(){k(t.result)},console.log(t)}(e)}}),r.a.createElement("div",{className:"image-container"},r.a.createElement("img",{src:T,alt:""})),r.a.createElement("div",{className:"radio-btns"},r.a.createElement("p",null,"Publish?"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"published"},"Yes"),r.a.createElement(h,{value:"true",handleChange:function(e){return x(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"published"},"No"),r.a.createElement(h,{value:"false",handleChange:function(e){return x(e.target.value)}}))),r.a.createElement("button",null,"Create Post")))}function g(e){var t=e.showDeleteConfirm,a=e.handleClick,c=e.postId,l=Object(n.useState)(""),s=Object(o.a)(l,2),m=s[0],p=s[1],h=function(){var e=Object(i.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(c,"/delete"),{method:"delete",mode:"cors",headers:{"Content-Type":"application/json",Authorization:d()}});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,p(a.message);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"delete-confirmation ".concat(t?"active":"")},"Are you sure you want to delete this post?"," ",r.a.createElement("button",{type:"button",onClick:h},"Yes")," ",r.a.createElement("button",{type:"button",onClick:a},"No"),r.a.createElement("p",null,m))}function E(e){var t=e.handleSubmit,a=e.published;return r.a.createElement("form",{onSubmit:function(e){return t(e)}},a?r.a.createElement("div",{className:"unpublish-wrapper"},r.a.createElement("p",null,"This post is published."),r.a.createElement("button",null,"Unpublish")):r.a.createElement("div",{className:"publish-wrapper"},r.a.createElement("p",null,"This post hasn't been published."),r.a.createElement("button",null,"Publish")))}function v(e){var t=e.published,a=e.changePublishedStatus,n=e.editPost,c=e.setShowDeleteConfirm,l=e.openComments;return r.a.createElement("div",{className:"action-btns"},r.a.createElement(E,{published:t,handleSubmit:a}),r.a.createElement("div",{className:"delete-edit-wrapper"},r.a.createElement("button",{type:"button",className:"edit-btn",onClick:l},"See comments"),r.a.createElement("button",{type:"button",className:"edit-btn",onClick:n},"Edit"),r.a.createElement("button",{type:"button",className:"delete-btn",onClick:function(){return c(!0)}},"Delete")))}function j(e){var t=e.title,a=e.timestamp,c=e.last_update,l=e.published,s=e._id,p=e.currentUser,h=e.image,b=Object(n.useState)(!1),f=Object(o.a)(b,2),E=f[0],j=f[1],O=Object(m.f)(),x=function(){var e=Object(i.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(s,"/update-published-status"),{method:"put",mode:"cors",headers:{"Content-Type":"application/json",Authorization:d()},body:JSON.stringify({published:!l})});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,console.log(n),window.location.reload(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)(u.a.mark((function e(){var t,a,n,r,c,l,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(s));case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,console.log(a),n=a.foundPost,r=n.title,c=n.text,l=n.published,o=n.image,O.push({pathname:"/post/".concat(s,"/edit"),state:{title:r,text:c,published:l,_id:s,image:o}});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(i.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(s,"/comments"));case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,O.push({pathname:"/post/".concat(s,"/comments"),state:{comments:a}});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("article",{className:"post"},r.a.createElement("h2",null,t),r.a.createElement("figure",null,r.a.createElement("img",{src:h,alt:""}),r.a.createElement("figcaption",null,r.a.createElement("p",{className:"timestamps"},r.a.createElement("span",{className:"date"},"Created on ",a," "),r.a.createElement("span",{className:"last-update"},"Last updated on: ",c||"No updates yet.")))),p&&r.a.createElement(v,{published:l,changePublishedStatus:x,editPost:y,setShowDeleteConfirm:j,openComments:w})),r.a.createElement(g,{showDeleteConfirm:E,handleClick:function(){return j(!1)},postId:s}))}function O(e){var t=e.currentUser,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1];return Object(n.useEffect)((function(){(function(){var e=Object(i.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://julio22b-blog-api-1.glitch.me/api/posts");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,s(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"post-list"},l.map((function(e){return r.a.createElement(j,{title:e.title,timestamp:e.timestamp,last_update:e.last_update,published:e.published,key:e._id,_id:e._id,currentUser:t,image:e.image})}))))}function x(e){var t=e.postId,a=e.commentId,c=e.username,l=e.timestamp,s=e.text,m=Object(n.useState)(""),p=Object(o.a)(m,2),h=p[0],b=p[1],f=Object(n.useState)(""),g=Object(o.a)(f,2),E=g[0],v=g[1],j=Object(n.useState)(!1),O=Object(o.a)(j,2),x=O[0],y=O[1],w=Object(n.useState)(!0),S=Object(o.a)(w,2),k=S[0],N=S[1],C=function(){var e=Object(i.a)(u.a.mark((function e(n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("http://localhost:4000/api/post/".concat(t,"/comments/").concat(a),{method:"put",mode:"cors",headers:{"Content-Type":"application/json",Authorization:d()},body:JSON.stringify({comment:E})});case 3:return r=e.sent,e.next=6,r.json();case 6:c=e.sent,v(c.text),y(!x);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(i.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(t,"/comments/").concat(a),{method:"delete",mode:"cors",headers:{"Content-Type":"application/json",Authorization:d()}});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,b(r.message),N(!k),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("article",{className:"comment"},r.a.createElement("div",null,r.a.createElement("h5",null,c),r.a.createElement("span",{className:"date"},l)),r.a.createElement("p",{className:"comment-text"},E||s),k&&r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{className:"edit-btn",onClick:function(){return y(!x)},type:"button"},"Edit"),r.a.createElement("button",{className:"delete-btn",onClick:T,type:"button"},"Delete")),r.a.createElement("p",null,h),r.a.createElement("form",{className:x?"active":"",onSubmit:function(e){return C(e)}},r.a.createElement("textarea",{name:"comment",cols:"30",rows:"5",onChange:function(e){return v(e.target.value)},defaultValue:s}),r.a.createElement("button",null,"Send")))}function y(e){e.location;var t=e.match,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1];return Object(n.useEffect)((function(){(function(){var e=Object(i.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(t.params.id,"/comments"));case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,s(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}})()()}),[t.params.id]),r.a.createElement("section",{className:"comments-section"},l.map((function(e){return r.a.createElement(x,{postId:t.params.id,commentId:e._id,username:e.username,text:e.text,timestamp:e.timestamp,key:e._id})})))}var w=a(9),S="http://localhost:4000/api";function k(){return(k=Object(i.a)(u.a.mark((function e(t,a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(S,"/log-in"),{method:"post",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({username:t,password:a})});case 2:return n=e.sent,e.next=5,n.json();case 5:return(r=e.sent).token&&localStorage.setItem("currentUser",JSON.stringify(r)),console.log(r),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N={logIn:function(e,t){return k.apply(this,arguments)},logOut:function(){localStorage.removeItem("currentUser")},getUser:function(){return JSON.parse(localStorage.getItem("currentUser"))}};function C(e){var t=e.handleSubmit,a=e.state,c=e.setTitle,l=e.setText,o=e.setPublished,s=e.setImage,u=e.image,i=e.btnText,m=Object(n.useRef)();return r.a.createElement("form",{className:"create-form",onSubmit:function(e){return t(e)},encType:"multipart/form-data"},r.a.createElement("label",{htmlFor:"title"},"Title: "),r.a.createElement("input",{type:"text",name:"title",required:!0,defaultValue:a?a.title:"",onChange:function(e){return c(e.target.value)}}),r.a.createElement("label",{htmlFor:"text"},"Content: "),r.a.createElement(b.Editor,{previewStyle:"vertical",initialEditType:"markdown",height:"700px",events:{change:function(){return l(m.current.getInstance().getMarkdown())}},ref:m,initialValue:a?a.text:""}),r.a.createElement("label",{htmlFor:"image"},"Image: "),r.a.createElement("input",{type:"file",name:"image",onChange:function(e){return function(e){var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(){s(t.result)}}(e)}}),r.a.createElement("div",{className:"image-container"},r.a.createElement("img",{src:u,alt:""})),r.a.createElement("div",{className:"radio-btns"},r.a.createElement("p",null,"Publish?"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"published"},"Yes"),r.a.createElement(h,{value:"true",handleChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"published"},"No"),r.a.createElement(h,{value:"false",handleChange:function(e){return o(e.target.value)}}))),r.a.createElement("button",null,i))}function T(e){var t=e.location,a=Object(n.useState)(t.state.title||""),c=Object(o.a)(a,2),l=c[0],s=c[1],p=Object(n.useState)(t.state.text||""),h=Object(o.a)(p,2),b=h[0],f=h[1],g=Object(n.useState)(t.state.published),E=Object(o.a)(g,2),v=E[0],j=E[1],O=Object(n.useState)(t.state.image||""),x=Object(o.a)(O,2),y=x[0],w=x[1],S=Object(n.useState)(""),k=Object(o.a)(S,2),N=k[0],T=k[1],F=Object(m.f)();window.scrollTo(0,0);var I=function(){var e=Object(i.a)(u.a.mark((function e(a){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,fetch("https://julio22b-blog-api-1.glitch.me/api/post/".concat(t.state._id,"/update"),{method:"put",mode:"cors",headers:{"Content-Type":"application/json",Authorization:d()},body:JSON.stringify({title:l,text:b,published:v,image:y})});case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,console.log(r),T(r.msg),F.push("/home"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,N),r.a.createElement(C,{handleSubmit:I,state:t.state,setTitle:s,setText:f,setPublished:j,setImage:w,image:y,btnText:"Edit Post"}))}var F=function(){var e=Object(n.useState)(JSON.parse(localStorage.getItem("currentUser"))),t=Object(o.a)(e,2),a=t[0],c=t[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null,r.a.createElement("header",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(w.b,{to:"/home"},"Home")),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(w.b,{to:"/create"},"Create post")),r.a.createElement("li",null,r.a.createElement(w.b,{to:"/log-in"},r.a.createElement("button",{onClick:function(){c(""),N.logOut()}},"Log out")))):r.a.createElement("li",null,r.a.createElement(w.b,{to:"/log-in"},"Log in"))))),a?r.a.createElement("h2",null,"Hello ",a.username,"."):r.a.createElement("h2",null,"Log in to create and edit your posts."),!a&&r.a.createElement(m.a,{path:"/log-in",component:p}),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/home",exact:!0,render:function(e){return r.a.createElement(O,Object.assign({},e,{currentUser:a}))}}),r.a.createElement(m.a,{path:"/create",exact:!0,component:f}),";",r.a.createElement(m.a,{path:"/post/:id/edit",exact:!0,render:function(e){return r.a.createElement(T,e)}}),r.a.createElement(m.a,{path:"/post/:id/comments",exact:!0,component:y}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.de9a65e3.chunk.js.map